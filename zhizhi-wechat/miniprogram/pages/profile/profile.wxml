<!--profile.wxml-->
<scroll-view class="container" scroll-y bindrefresherrefresh="onPullDownRefresh" refresher-enabled="true">
  <!-- 用户信息区域 -->
  <view class="user-section">
    <view class="user-info" wx:if="{{userInfo}}">
      <image class="user-avatar" src="{{userInfo.avatar_url || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="user-details">
        <text class="user-name">{{userInfo.name}}</text>
        <text class="user-email">{{userInfo.email}}</text>
        <text class="user-phone" wx:if="{{userInfo.phone}}">{{userInfo.phone}}</text>
      </view>
      <image class="edit-icon" src="/images/edit.png" mode="aspectFit" bindtap="navigateToSettings"></image>
    </view>
    
    <!-- 未登录状态 -->
    <view class="login-prompt" wx:else>
      <image class="login-avatar" src="/images/default-avatar.png" mode="aspectFill"></image>
      <text class="login-text">登录后查看个人信息</text>
      <button class="login-btn" bindtap="navigateToLogin">立即登录</button>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section">
    <!-- 我的预约 -->
    <view class="menu-item" bindtap="navigateToAppointments">
      <view class="menu-left">
        <image class="menu-icon" src="/images/appointment.png" mode="aspectFit"></image>
        <text class="menu-text">我的预约</text>
      </view>
      <image class="menu-arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <!-- 我的收藏 -->
    <view class="menu-item">
      <view class="menu-left">
        <image class="menu-icon" src="/images/favorite.png" mode="aspectFit"></image>
        <text class="menu-text">我的收藏</text>
      </view>
      <image class="menu-arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <!-- 我的评价 -->
    <view class="menu-item">
      <view class="menu-left">
        <image class="menu-icon" src="/images/review.png" mode="aspectFit"></image>
        <text class="menu-text">我的评价</text>
      </view>
      <image class="menu-arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <!-- 健康档案 -->
    <view class="menu-item">
      <view class="menu-left">
        <image class="menu-icon" src="/images/health.png" mode="aspectFit"></image>
        <text class="menu-text">健康档案</text>
      </view>
      <image class="menu-arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>
  </view>

  <!-- 设置菜单 -->
  <view class="menu-section">
    <!-- 通知设置 -->
    <view class="menu-item" bindtap="navigateToSettings">
      <view class="menu-left">
        <image class="menu-icon" src="/images/notification.png" mode="aspectFit"></image>
        <text class="menu-text">通知设置</text>
      </view>
      <image class="menu-arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <!-- 隐私设置 -->
    <view class="menu-item">
      <view class="menu-left">
        <image class="menu-icon" src="/images/privacy.png" mode="aspectFit"></image>
        <text class="menu-text">隐私设置</text>
      </view>
      <image class="menu-arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <!-- 关于我们 -->
    <view class="menu-item" bindtap="navigateToAbout">
      <view class="menu-left">
        <image class="menu-icon" src="/images/about.png" mode="aspectFit"></image>
        <text class="menu-text">关于我们</text>
      </view>
      <image class="menu-arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>
  </view>

  <!-- 联系我们 -->
  <view class="contact-section">
    <view class="contact-title">联系我们</view>
    <view class="contact-item" bindtap="makePhoneCall">
      <image class="contact-icon" src="/images/phone.png" mode="aspectFit"></image>
      <text class="contact-text">客服电话：400-123-4567</text>
    </view>
    <view class="contact-item" bindtap="copyWechat">
      <image class="contact-icon" src="/images/wechat.png" mode="aspectFit"></image>
      <text class="contact-text">客服微信：zhizhi_health</text>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="logout-section" wx:if="{{userInfo}}">
    <button class="logout-btn" bindtap="showLogoutConfirm">退出登录</button>
  </view>

  <!-- 版本信息 -->
  <view class="version-info">
    <text class="version-text">版本 v1.0.0</text>
  </view>

  <!-- 退出登录确认弹窗 -->
  <view class="modal-mask" wx:if="{{showLogoutModal}}" bindtap="hideLogoutModal"></view>
  <view class="logout-modal" wx:if="{{showLogoutModal}}">
    <view class="modal-header">
      <text class="modal-title">确认退出</text>
    </view>
    <view class="modal-content">
      <text class="modal-text">确定要退出登录吗？</text>
    </view>
    <view class="modal-actions">
      <button class="modal-btn cancel" bindtap="hideLogoutModal">取消</button>
      <button class="modal-btn confirm" bindtap="handleLogout">确定</button>
    </view>
  </view>
</scroll-view>